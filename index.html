<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Python course</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <link rel="stylesheet" href="css/reveal.css"/>
    <link rel="stylesheet" href="css/theme/simple.css" id="theme"/>
    <link rel="stylesheet" href="extras.css"/>

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css" />

    <!-- If the query includes 'print-pdf', use the PDF print sheet -->
    <script>
      document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">');</script>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">

<!-- BEGIN slide content -->

	<section id="start">
	  <h2>Python Course: DTOcean</h2>
	  <p>Matthew Richardson</p>
	  <p>July 2014</p>
	</section>

	<section id="setup">
	  <section>
	    <h2>Getting Started</h2>
	  </section>

    <section>
      <h3>Installation</h3>
      <p>See installation notes from Course email...</p>
    </section>

    <section>
      <h3>Running Python</h3>

      <h3>Shell</h3>
      <pre>
> python
Python 2.7.6 (default, Mar 22 2014, 22:59:56)
[GCC 4.8.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>>
</pre>
      <h3>Script</h3>
<pre>
> python my_script.py
</pre>
    </section>

  </section>

  <section id="python">
    <section>
      <h2>Python Structure</h2>
    </section>

  <section id="hello">
    <h3>greetings.py</h3>
    <pre>

print("Hello!")

# This line is a comment and will be ignored

</pre>
  </section>

  <section id="methods">
    <h3>Methods</h3>
<pre>

# Create a method, that takes one argument
# (Notice the colon and indentation)
def hello(person):
    print("Hello " + person)

# Now 'call' this method with an argument
hello("John")

</pre>

</section>

  <section id="main">
    <h3>As a command</h3>
    <pre>

# Create a method, that takes one argument
def hello(person):
    print("Hello " + person)

# Call the hello method if we're run as a command
if __name__ == "__main__":
    hello("John")

</pre>
</section>


  <section id="main">
    <h3>As a module</h3>
    <pre>

# Load the greetings module
import greetings

# Call the hello method from the greetings module
greetings.hello("John")


</pre>
</section>

  <section id="packages">
    <h3>Package Structure</h3>
    <br/>
    <ul style="list-style-type: none;">
      <li>greetings/</li>
      <ul style="list-style-type: none;">
        <li>__init__.py</li>
        <li>Spanish.py</li>
      </ul>
      <ul style="list-style-type: none;">
        <li>English/</li>
        <ul style="list-style-type: none;">
          <li>__init__.py</li>
          <li>Australian.py</li>
        </ul>
        <li>French/</li>
        <ul style="list-style-type: none;">
          <li>__init__.py</li>
        </ul>
      </ul>
    </ul>

</section>

  <section id="imports">
    <h3>Imports from Packages</h3>
    <pre>

from greetings import English, French, Spanish
English.hello("John")
French.bonjour("John")
Spanish.hola("John") # from Spanish.py


from greetings.English import Australian
Australian.gday("mate")

</pre>

</section>
</section>


<section id="data">
<section>
<h2>Data Types</h2>
</section>

<section>
<h3>Strings, Bools, Ints, Floats...</h3>
<pre>

0 == False
<strong>True</strong>
1 == True
<strong>True</strong>

"cat" == True
<strong>False</strong>

1 + 3.1415
<strong>4.1415</strong>

"cat" + "dog"
<strong>catdog</strong>

"cat" + 2
<strong>TypeError: cannot concatenate 'str' and 'int'</strong>

"cat".upper()
<strong>CAT</strong>
</pre>
</section>

<section>
<h3>Lists</h3>
<pre>
animals = ["lion", "tiger", "wolf"]
len(animals)
<strong>3</strong>

for animal in animals:
    print(animal)
<strong>lion
tiger
wolf</strong>

animals[0]
<strong>lion</strong>

>>> animals[-1]
<strong>wolf</strong>

>>> animals[1][1:4]
<strong>ige</strong>

>>> animals.append("elephant")
>>> animals.extend(["frog", "giraffe"])

</pre>
</section>

<section>
<h3>Tuples</h3>
<pre>

animals = ("lion", "tiger", "wolf")
single_item = ("cat",)

len(animals)
<strong>3</strong>

for animal in animals:
    print(animal)
<strong>lion
tiger
wolf</strong>

animals[0]
<strong>lion</strong>

animals.append("elephant")
<strong>AttributeError: 'tuple' object has no attribute 'append'</strong>

</pre>
</section>


<section>
<h3>Dictionaries</h3>
<pre>

ages = {"Alice":25, "Bob": 54, "Charles": 34}

for person, age in ages.items():
    print(person, age)
<strong>Charles 34
Alice 25
Bob 54</strong>

ages['Bob']
<strong>54</strong>

ages["David"] = 67

</pre>
</section>

<section>
<h3>Nesting in Data Objects</h3>
<pre>

fish = ["cod", "carp", "mackerel"]

animals = [["lion", "tiger"],
           ["wolf"],
           fish]

animals[1][0]
<strong>wolf</strong>

animals[2][2][3:]
<strong>kerel</strong>

ages = {"female":{"Alice":25},
            "male":{"Bob":54, "Charles":34}}

ages["male"]["Bob"]
<strong>54</strong>

</pre>
</section>

<section>
<h3>if/else</h3>
<pre>

a = "cat"
if a: # Will be True

a = None
if a: # Will be False

if a is not None: # a is defined

if a == 1:
    x()
elif a == 1.5:
    y()
elif a <= 2:
    z()
else:
    pass

sizes = ["small", "medium", "large"]
if "large" in sizes: # Will be True

people = {"Alice": 26, "Bob": 54}
if 54 in people.values():

</pre>
</section>
</section>


<section id="morepython">
<section>
<h2>Further Python</h2>
</section>

<section id="returns">
<h3>Returns</h3>
<pre>

def hello(person):
    return "Hello " + person

answer = hello("John")
print(answer)

print(hello("Jack"))

</pre>
</section>

<section>
<h2>String Formatting</h2>
<pre>
print("Hello " + "Bob" + "how are you?")

print("{} {}, {}?".format("Hello", "Bob", "how are you"))
<strong>Hello Bob, how are you?</strong>

"{0} {1}, {2} {1}?".format("Hello", "Bob", "how are you")
<strong>Hello Bob, how are you Bob?</strong>

"|{:.6f} * {:.2f}|".format(3.14, 3.141592654)
<strong>3.140000 * 3.14</strong>

"=={0:<6}:{1:^10}:{2:>6}==".format("Left", "Centre", "Right")
<strong>==Left  :  Centre  : Right==</strong>


"{:.1%}".format(0.995)
<strong>99.5%</strong>

"{:,}".format(987654321)
<strong>987,654,321</strong>

</pre>
</section>


<section id="errorhandling">
<h3>Errors and Exceptions</h3>
<pre>

a = 1/0
<strong>Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
ZeroDivisionError: integer division or modulo by zero</strong>

try:
    a = 1/0
except ZeroDivisionError:
    print("Can't divide by zero")
    return False

<strong>Can't divide by zero</strong>
</pre>

</section>

<section>
<h3>Everything is an Object</h3>
<pre>

def double(num):
    return num * 2

def half(num):
    return num * 2

print(double(half(100)))

numbers = [10, 50]
methods = [double, half]

for number in numbers:
    for method in methods:
        print(method(number))

</pre>
</section>

<section>
<h3>Named and Optional Arguments</h3>
<pre>

def add(first, second=2, third=3):
    print(first + second + third)

add(1)
<strong>6 (1+2+3)</strong>

add(5,6)
<strong>14 (5+6+3)</strong>

add(third=7, second=8, first=9)
<strong>24 (9+8+7)</strong>

add(1, third=10):
<strong>13 (1+2+10)</strong>

</pre>
</section>


<section>
<h3>Introspection</h3>
<pre>

type("cat")
<strong>&lt;type 'str'&gt;</strong>

isinstance("cat", float)
<strong>False</strong>

dir("cat")
<strong>[... 'capitalize', 'center', 'count', 'decode', 'encode', 'endswith', 'expandtabs', 'find', 'format', 'index', 'isalnum', 'isalpha', 'isdigit', 'islower', 'isspace', ... ]</strong>

hasattr("cat", "islower")
<strong>True</strong>

"cat".islower.__doc__
<strong>S.islower() -> bool

Return True if all cased characters in S are lowercase and there is
at least one cased character in S, False otherwise.</strong>

</pre>
</section>

<section>
<h3>Object-Oriented Python</h3>
<pre>

class Animal(object):

    def __init__(self, continent):
        self.continent = continent
        self.eat = "nothing"

    def come_from(self):
        return self.continent

zebras = Animal("Africa")
koalas = Animal("Australia")

print(zebras.come_from())
print(koalas.come_from())

print(koalas.eat)
koalas.eat = "eucalyptus"
print(koalas.eat)

</pre>
</section>
</section>

<section id="sql">
<section>
<h2>Python Database Access</h2>
</section>

<section id="trad">
<h3>DB-API SQL Querying</h3>
<pre>

import sqlite3 # or psycopg2, or mysql, ...

conn = sqlite3.connect('staff.db')
c = conn.cursor()

for entry in c.execute("SELECT name, salary FROM managers WHERE name = 'John'"):
    print(entry[0], entry[1])

</pre>
</section>


<section id="sqlalchemy">
<h3>SQL Alchemy: Querying</h3>
<pre>

from sqlalchemy import orm, create_engine, MetaData

db = create_engine('sqlite:///staff.db')
metadata = MetaData(db)
session = orm.sessionmaker(bind=db)()

h_val = metadata.tables["managers"].columns

for entry in session.query(h_val.name,
                           h_val.salary).\
                           filter(h_val.name == 'John'):
    print(entry.name, entry.salary)

</pre>


</section>

<section>
<h3>DB-API: DB Creation</h3>
<pre>

import sqlite3 as dbapi
# or psycopg2, or sqlite3...

conn = dbapi.connect('staff.db')
c = conn.cursor()

c.execute("""CREATE TABLE managers
             (id INTEGER PRIMARY KEY AUTOINCREMENT, name VARCHAR, salary INTEGER)""")

c.execute("INSERT INTO managers(name,salary) VALUES("John",30000)")

c.commit()

</pre>
</section>

<section>
<h3>SQL Alchemy: DB Creation</h3>
<pre>

from sqlalchemy import orm, create_engine, MetaData, Sequence, Column, Integer, String
from sqlalchemy.ext.declarative import declarative_base

db = create_engine('sqlite:///staff.db')
session = orm.sessionmaker(bind=db)()

Base = declarative_base()

class Manager(Base):
    __tablename__ = 'managers'

    id = Column(Integer, Sequence('id'), primary_key=True)
    name = Column(String)
    salary = Column(Integer)

# Create tables for all classes inheriting from Base
Base.metadata.create_all(db)

john = Manager(name="John", salary=30000)
session.add(john)
session.commit()

</pre>
</section>

</section>

<section id="pythonic">
<section>
<h2>Writing 'Good' Python</h2>
</section>

    <section id="zen">
      <h3>Zen of Python</h3>
      <pre>&gt; import this</pre>
      <pre class="fragment">
    Beautiful is better than ugly.
    Explicit is better than implicit.
    Simple is better than complex.
    Complex is better than complicated.
    Readability counts.
    ...</pre>
    </section>

<section>
<h3>Documentation</h3>
<pre>
"""A module which greets you."""

def hello(person):
    """Takes a string, returns a string."""
    return "Hello " + person
</pre>
<pre>

>>> help(greetings)
Help on module greetings:

NAME
    greetings - A module which greets you.

FILE
    /tmp/greetings.py

FUNCTIONS
    hello(person)
        Takes a string, returns a string.

</pre>
</section>

<section>
<h3>PEP8</h3>
<a href="http://legacy.python.org/dev/peps/pep-0008/">PEP8 Style Guidelines</a>

<pre>
import greetings
list=["John","Jack"]
for person in list:
   print("Hello " + person)

</pre>
<pre>
> pep8 badcode.py
2:5: E225 missing whitespace around operator
2:13: E231 missing whitespace after ','
4:4: E111 indentation is not a multiple of four
5:1: W391 blank line at end of file
</pre>
</section>

<section>
<h3>Pylint Code Analysis</h3>
<a href="http://www.pylint.org">www.pylint.org</a>
<pre>
import greetings
list = ["John", "Jack"]
for person in list:
    print("Hello " + person)
</pre>
<pre>
> pylint badcode.py
W:  2, 0: Redefining built-in 'list' (redefined-builtin)
C:  1, 0: Missing module docstring (missing-docstring)
W:  1, 0: Unused import greetings (unused-import)
...
Your code has been rated at 4.00/10 (previous run: -2.00/10, +6.00)

</pre>



</section>
</section>

<section id="project">

<section>
<h2>Sample Project</h2>
</section>

<section>
<h3>Brief</h3>
<p>A property developer wants to build houses at one of 3 regions:</p>
<ul>
<li>England</li>
<li>Ireland</li>
<li>Scotland</li>
</ul>

<p>They will build an estate consisting of houses of one of 3 sizes:</p>
<ul>
<li>small</li>
<li>medium</li>
<li>large</li>
</ul>

<p>Build cost varies with house size and region.</p>
<p>Allowed houses per acre varies between regions.</p>
<p>House prices also vary between regions.</p>

<p>Which locations are the best and worst to build in to maximise profit?</p>

</section>

<section>
<h3>Tasks</h3>
<p>You are working as part of a team on a Python package called <em>housecost.</em></p>
<p>Another developer has already written a Python module called <em>fakedb</em>  in this package. This module provides a <em>query</em> method, which returns data from one of 3 db tables:</p>
<ul>
<li>build_cost - the cost to build a house</li>
<li>value - the price a house sells for</li>
<li>density - the number of houses per acre</li>
</ul>
<p>This data is returned as a nested dictionary, containing numbers for each size and region.</p>
<p>Your task is to write a new module for the <em>housecost</em> package, called <em>calculate</em> which contains a method called <em>profit</em>.  This method should take size and region as arguments, and return the profit for that region.</p>
</section>

<section>
<h3>Work-list</h3>
<ul>
<li>Download the <a href="http://github.com/mrichar1/dtocean-course/tree/master">housecost</a> package source (http://bit.ly/1ohTZsF).</li>
<li>Create <em>calculate</em> module alongside existing <em>fakedb</em> module.</li>
<li>import <em>fakedb</em> and instantiate it's <em>DB</em> class to get access to its <em>query</em> method.</li>
<li>Use introspection to find out what arguments <em>query</em> requires.</li>
<li>Use introspection to look at the data returned by <em>query</em>.</li>
<li>Define a method called <em>profit</em> that takes 2 arguments: <em>size</em> and <em>region</em>, calls <em>query</em> and calculates the profit with the data returned.</li>
<li>Write a script called <em>profit-table.py</em> (outside of <em>housecost</em>) to import <em>calculate</em>, and call <em>profit</em> for all combinations of <em>size</em> and <em>region</em>, then print a matrix of all sizes, regions and profits.</li>
</ul>
</section>

<section>
<h3><a href="http://github.com/mrichar1/dtocean-course/tree/answers">An Answer</a></h3>
</section>

</section>

<section id="questions">
  <h2>Any Questions?</h2>
  <p>m.richardson@ed.ac.uk</p>
</section>


<!-- END Slide content -->

    </div> <!-- class=slides -->
    </div> <!-- class=reveal -->

<script src="lib/js/head.min.js"></script>
    <script src="js/reveal.min.js"></script>

    <script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
    controls: true,
    progress: false,
    history: true,
    center: true,
    theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
    transition: Reveal.getQueryHash().transition || 'linear', // default/cube/page/concave/zoom/linear/fade/none

    // Optional libraries used to extend on reveal.js
    dependencies: [
        { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
        { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
        { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
        { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
    ]
});
    </script>



  </body>
</html>
